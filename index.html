<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>iOS Chat</title>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<style>
:root{
  --bg:#000;
  --bubble-me:#007aff;
  --bubble-other:#2c2c2e;
  --text-me:#fff;
  --text-other:#fff;
  --accent:#007aff;
  --safe:env(safe-area-inset-bottom,20px);
  font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:#fff;display:flex;flex-direction:column;height:100vh;overflow:hidden;}

/* ====== LOGIN SCREEN (iOS-style) ====== */
.login{
  position:fixed;inset:0;
  background:#000;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:999;
  transition:opacity .35s, transform .35s;
}
.login.hide{opacity:0;transform:scale(1.05);pointer-events:none;}
.login h2{margin-bottom:24px;font-weight:600;font-size:24px;}
.login input{
  background:#1c1c1e;
  color:#fff;
  border:none;
  border-radius:12px;
  padding:14px 18px;
  width:260px;
  font-size:17px;
  text-align:center;
}
.login button{
  margin-top:16px;
  background:var(--accent);
  color:#fff;
  border:none;
  border-radius:12px;
  padding:12px 0;
  width:260px;
  font-size:17px;font-weight:600;
  cursor:pointer;
}

/* ====== CHAT STYLES (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ====== */
.header{background:#1c1c1e;padding:12px 20px calc(12px + env(safe-area-inset-top,0));display:flex;align-items:center;gap:12px;border-radius:0 0 24px 24px;}
.avatar{width:38px;height:38px;border-radius:50%;background:url(https://i.pravatar.cc/80?u=ios) center/cover;}
.name{font-size:17px;font-weight:600;flex:1;}
.status{font-size:14px;color:#8e8e93;}
.messages{flex:1;overflow-y:auto;padding:16px 20px calc(16px + var(--safe));scroll-behavior:smooth;}
.messages::-webkit-scrollbar{display:none;}
.bubble{max-width:72%;padding:10px 14px;margin-bottom:6px;line-height:1.35;font-size:16px;position:relative;word-wrap:break-word;}
.bubble.me{background:var(--bubble-me);color:var(--text-me);border-radius:18px 4px 18px 18px;margin-left:auto;}
.bubble.other{background:var(--bubble-other);color:var(--text-other);border-radius:4px 18px 18px 18px;}
.bubble .meta{font-size:12px;color:#8e8e93;margin-top:4px;text-align:right;}
.inputBar{background:#1c1c1e;padding:8px 20px calc(8px + var(--safe));display:flex;align-items:flex-end;gap:8px;border-radius:24px 24px 0 0;}
.inputBar textarea{flex:1;background:#2c2c2e;color:#fff;border:none;border-radius:18px;padding:10px 14px;font-size:17px;resize:none;max-height:100px;font-family:inherit;}
.inputBar textarea:focus{outline:none;}
.inputBar button{background:var(--accent);color:#fff;border:none;width:36px;height:36px;border-radius:50%;display:grid;place-items:center;flex-shrink:0;cursor:pointer;}
.inputBar button svg{width:22px;height:22px;fill:#fff;}
</style>
</head>
<body>

<!-- ===== LOGIN ===== -->
<div class="login" id="login">
  <h2>–í–∞—à–µ –∏–º—è</h2>
  <input id="userName" placeholder="–ò–º—è" autocomplete="off" maxlength="20">
  <button id="enterBtn">–í–æ–π—Ç–∏</button>
</div>

<!-- ===== CHAT ===== -->
<header class="header">
  <div class="avatar"></div>
  <div>
    <div class="name">–ß–∞—Ç</div>
    <div class="status">–æ–Ω–ª–∞–π–Ω</div>
  </div>
</header>

<main class="messages" id="msgs"></main>

<form class="inputBar" id="form">
  <textarea id="inp" rows="1" placeholder="iMessage"></textarea>
  <button aria-label="Send">
    <svg viewBox="0 0 24 24"><path d="M3.6 2.3c-.4-.3-.9-.2-1.2.2l-.1.2v.2l2.6 9.7c.1.3.4.4.6.2l3.4-2.8-3.3-7.5zm18.2 9.8L6 21.5c-.4.3-.9.1-1-.4L2.1 5.8c-.1-.4.2-.8.6-.9l16.7-6.3c.4-.1.8.2.9.6.1.2 0 .4-.1.6l-5.5 12.3z"/></svg>
  </button>
</form>

<script>
const $ = s => document.querySelector(s);
const login   = $('#login');
const userInp = $('#userName');
const enter   = $('#enterBtn');
const msgs    = $('#msgs');
const inp     = $('#inp');
const form    = $('#form');

let myName = '';

enter.addEventListener('click',loginHandler);
userInp.addEventListener('keydown',e=>{if(e.key==='Enter')loginHandler();});

function loginHandler(){
  const n = userInp.value.trim();
  if(!n) return;
  myName = n;
  login.classList.add('hide');
  inp.focus();
  addBubble(`üëã ${myName} –≤–æ—à—ë–ª(–ª–∞) –≤ —á–∞—Ç`,false,'system');
}

form.addEventListener('submit',e=>{
  e.preventDefault();
  if(!inp.value.trim()||!myName) return;
  addBubble(inp.value.trim(),true);
  inp.value='';inp.style.height='auto';
  setTimeout(()=>addBubble(randomReply(),false),700);
});

inp.addEventListener('input',()=>{
  inp.style.height='auto';
  inp.style.height=inp.scrollHeight+'px';
});

function addBubble(text,isMe,meta){
  const div=document.createElement('div');
  div.className='bubble '+(isMe?'me':'other');
  div.textContent=text;
  if(meta!=='system'){
    const small=document.createElement('div');
    small.className='meta';
    small.textContent=isMe?myName:'–°–æ–±–µ—Å–µ–¥–Ω–∏–∫';
    div.appendChild(small);
  }
  msgs.appendChild(div);
  msgs.scrollTop=msgs.scrollHeight;
}
function randomReply(){
  const pool=['–û–≥–æ, –ø—Ä—è–º –∫–∞–∫ –Ω–∞ –∞–π—Ñ–æ–Ω–µ!','–ö—Ä—É—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å üòé','–ï—â—ë –±—ã —Ç—ë–º–Ω—É—é —Ç–µ–º—É... –æ, —É–∂–µ –µ—Å—Ç—å!','–ü–æ–ø—Ä–æ–±—É–π –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ—â—ë'];
  return pool[Math.floor(Math.random()*pool.length)];
}
</script>
</body>
</html>
